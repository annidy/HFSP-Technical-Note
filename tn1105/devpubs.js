/* Copyright Â© 2010 Apple Inc.  All rights reserved. */
var COOKIE_EXPIRE_DATE=new Date();COOKIE_EXPIRE_DATE.setFullYear(COOKIE_EXPIRE_DATE.getFullYear()+1);Prototype.Browser.Xcode=navigator.userAgent.indexOf("Xcode/")>-1;Prototype.Browser.XcodeVersion=parseFloat(navigator.userAgent.slice(navigator.userAgent.indexOf("Xcode/")+6,navigator.userAgent.length));Prototype.Browser.Xcode4OrNewer=Prototype.Browser.XcodeVersion<1000;String.prototype.directoryForURL=function(){var a=this.split("#")[0];return a.replace(/[^\/]+\.[^\/]+$/,"")};String.prototype.isHTTPurl=function(){return this.match(/^https?:\/\//)};function LocationHash(a){this.observerID=null;this.callBack=function(){};return this}LocationHash.prototype.setHashTo=function(a){this.stopObserving();window.location.hash=a;this.startObserving(this.callBack)};LocationHash.prototype.handleEvent=function(a){if(a.type==="hashchange"){if(typeof this.callBack==="function"){this.callBack(a)}else{this.callBack.handleEvent(a)}}};LocationHash.prototype.startObserving=function(b){var c=this;this.currentHash=window.location.hash;this.callBack=b;function a(){if(c.currentHash!==window.location.hash){c.handleEvent({type:"hashchange"});c.currentHash=window.location.hash}}this.observerID=window.setInterval(a,250)};LocationHash.prototype.stopObserving=function(){window.clearInterval(this.observerID)};var locationHash=new LocationHash();var Links={target:Prototype.Browser.Xcode?"__xcodeOpenInBrowser":"_blank",rootLocation:null,openInBrowser:function(a){for(var b=0;b<a.length;b++){if(a[b].up().hasClassName("pediaLink")||a[b].up().hasClassName("recipeLink")){a[b].href=a[b].href.split("#")[0]}else{a[b].target=a[b].hasClassName("browserLink")&&!Prototype.Browser.Xcode?"_top":Links.target}}return a},initClickInterceptor:function(){if(window.parent!==window){return}var a=$("contents-frame");if(!a){return}Event.observe(a,"load",function(b){Event.observe(a.contentWindow,"click",this.interceptClick.bindAsEventListener(this))}.bindAsEventListener(this));this.rootLocation=window.location},isExternalLink:function(b){var a=this.rootLocation.pathname;if(!b||!b.href){return false}if(b.href.match(/^\#/)){return false}if(b.className.match("browserLink")&&Prototype.Browser.Xcode){return false}if(b.className.match("urlLink")){return true}if(b.href.match("http://")&&!b.href.match(this.rootLocation.hostname)){return true}if(!b.href.match(a)){return true}return false},interceptClick:function(a){var b=a.target;if(b.tagName.toLowerCase()=="a"){if(this.isExternalLink(b)){b.target="_top"}}}};var DevPubs={init:function(){DevPubs.removeADCContent();Links.openInBrowser($$(".urlLink").concat($$(".browserLink")));Links.initClickInterceptor();DevPubs.initMovies($$(".moviePanel"));if(Prototype.Browser.WebKit){DevPubs.printFix()}},generator:document.getElementById("generator")?document.getElementById("generator").content:"Unknown",printFix:function(){if(window.parent!==window){return}var b=document.body,d=document.activeElement,c=$("contents-frame"),a=false;Event.observe(window,"keypress",function(e){if(e.metaKey&&e.which===112){d=document.activeElement;if(c){c.focus()}}});Event.observe(window,"mouseout",function(e){b=null;a=false;d=document.activeElement});Event.observe(window,"mouseover",function(e){b=e.element();a=!a});setInterval(function(){if(a){return}if(!b){if(c){a=true;c.focus()}}else{if(d&&d!==document.activeElement){d.focus();d=null}}},250)},setupRecipeMovie:function(b){var c=b.up(".overlay"),g=$("dimBackground"),a=c.up("figure"),f=c.next("img"),d=function(){c.show();b.down(".mediaControllerPanel").removeClassName("fade");g.style.zIndex=2;c.style.zIndex=3;g.style.opacity=1;c.style.opacity=1},e=function(){g.style.opacity=0;c.style.opacity=0;setTimeout(function(){g.style.zIndex=-1;c.style.zIndex=-1;c.hide()},300)};c.hide();c.down(".close-button").observe("click",function(){movieController.stop();movieController.reset();e()}.bindAsEventListener(this));if(!c.previous(".image-button")){c.insert({before:"<div class='image-button' role='button' title='Play Video'></div>"})}a.addClassName("floatright");f.addClassName("border-and-shadow");c.previous(".image-button").observe("click",function(){d();setTimeout(function(){movieController.play()},400)}.bindAsEventListener(this));$(document.body).observe("QuickTime:end",function(){setTimeout(function(){movieController.stop();movieController.reset();e()}.bind(this),800)}.bindAsEventListener(this))},initMovies:function(b,a){var a=a||"";if(typeof Media!=="undefined"&&!this._movies){Media.ControlsWidget.prototype._createTemplate=function(){function d(f){var h=document.createElement("div"),g;h.innerHTML=f;g=h.firstChild;return g}this.controllerType="regular";if(Media.Detection.Firefox()){this.container.addClassName("slim");this.controllerType="slim";if(this.container.offsetWidth<450&&!AC.Detector.isIEStrict()){this.container.addClassName("slim");this.container.addClassName("short-slim");this.controllerType="short-slim"}}var c=new Date();this.timestamp=c.getTime();this.container.appendChild(d(Media.ControlsWidget.TEMPLATE));this.element=$("ACMedia-controls");this.element.id="ACMedia-controls_"+this.timestamp}}b.each(function(c){this._movies=this._movies||[];if(this._movies.indexOf(c)<0){this._movies.push(c);this.enableMovie(c,a)}}.bind(this))},enableMovie:function(c,j){var b=c.up("div.inlinerecipe-content ")?true:false,d=c.up(".overlay"),h=d&&!b?true:false,i=c.next("img"),a=c.getStyle("height").replace("px",""),e=c.getStyle("width").replace("px",""),g=(b||h||c.getAttribute("data-useCustomControls")=="true")?false:true,f={autostart:false,bgcolor:"white",cache:true,controller:g,height:a,width:e};if(g){c.style["margin-bottom"]="25px"}if(i){f.posterFrame=i.getAttribute("src");i.remove()}movieController=Media.create(c,j+c.getAttribute("data-moviesrc"),f);if(b){d.next("img").remove()}else{if(h){DevPubs.setupRecipeMovie(c)}}if(!g){movieController.setControlPanel(new Media.ControlsWidget(c.down(".controllerPanel")))}},hideInXcode:function(){var a,b;a=$$(".hideInXcode");for(b=0;b<a.length;b++){a[b].hide()}return a},showInXcode:function(){var a,b;a=$$(".showInXcode");for(b=0;b<a.length;b++){a[b].show()}return a},removeADCContent:function(){if(Prototype.Browser.Xcode||($("adcHeader")&&$("adcHeader").innerText===""&&Page.type!=="Pedia"&&Page.type!=="Recipe")){DevPubs.hideInXcode();DevPubs.showInXcode();if(document.getElementById("header")&&$("contents")){document.getElementById("header").addClassName("noADC");$("contents").addClassName("noADC");if($("tocContainer")){$("tocContainer").addClassName("noADC")}if(Prototype.Browser.Xcode||(!$("breadcrumbs"))){if($("tocContainer")){$("tocContainer").addClassName("noBreadcrumbs")}$("contents").addClassName("noBreadcrumbs");if($("breadcrumbs")){$("breadcrumbs").hide()}}}}return $$(".noADC").concat($$(".hideInXcode").concat($$(".showInXcode")))},Window:function(e){var b,d,a,c;b=document.createElement("div");d=document.createElement("div");a=document.createElement("div");c=document.createElement("div");b.setAttribute("id",e+"Window");d.setAttribute("id",e+"Header");a.setAttribute("id",e+"Body");c.setAttribute("id",e+"Footer");b.appendChild(d);b.appendChild(a);b.appendChild(c);b.style.display="none";document.body.appendChild(b);this.box=$(e+"Window");this.header=$(e+"Header");this.contents=$(e+"Body");this.footer=$(e+"Footer")}};var Cookie={set:function(a){if((localStorage!==null)&&(typeof localStorage!=="undefined")){try{localStorage.setItem(a.cName,a.cValue)}catch(b){return b}return a.cValue}else{if(a.cDomain===""&&window.location.domain){a.cDomain=window.location.domain}return(document.cookie=a.cName+"="+escape(a.cValue)+(a.cExpiry?"; expires="+a.cExpiry.toGMTString():"")+(a.cDomain?"; domain="+a.cDomain:"")+(a.cPath?"; path="+a.cPath:"; path="+window.location.pathname))}},get:function(d){if(((localStorage!==null)&&(typeof localStorage!=="undefined"))&&localStorage.getItem(d)!=="null"){return localStorage.getItem(d)}else{var a,c,b;a=document.cookie.split(";");for(c=0;c<a.length;c++){b=a[c];while(b.charAt(0)===" "){b=b.substring(1,b.length)}if(b.indexOf(d+"=")===0){if((localStorage!==null)&&(typeof localStorage!=="undefined")){localStorage.setItem(d,b.substring(d.length+1,b.length));Cookie.forceExpire(d);return localStorage.getItem(d)}else{return b.substring(d.length+1,b.length)}}}return null}},expire:function(a){if((localStorage!==null)&&(typeof localStorage!=="undefined")){return localStorage.removeItem(a)}else{return Cookie.forceExpire(a)}},forceExpire:function(b){var a=new Date();a.setUTCFullYear(2000);return this.set({cName:b,cValue:null,cExpiry:a,cPath:"/"})}};function Querystring(a){var c,d,f,b,e;this.params={};if(!a){a=location.search.substring(1,location.search.length)}if(a.length===0){return null}c=a.replace(/\+/g," ").split("&");for(d=0;d<c.length;d++){f=c[d].split("=");b=decodeURIComponent(f[0]);e=(f.length===2)?decodeURIComponent(f[1]):b;this.params[b]=e}}Querystring.prototype.get=function(a,b){var c=this.params[a];return(c!==null)?c:b};Querystring.prototype.contains=function(a){var b=this.params[a];return(b!==null)};Prototype.Query=new Querystring();Prototype.HashQuery=new Querystring(location.hash.replace(/#/,""));var ToolTip={observeTips:function(b){for(var a=0;a<b.length;a++){b[a].observe("mouseover",ToolTip.show);b[a].observe("mouseout",ToolTip.hide)}return b},init:function(){ToolTip.container=document.createElement("div");ToolTip.container.id="tooltip";return ToolTip.observeTips($$("span.tooltip"))},show:function(b){var a=b.findElement("span");ToolTip.container.innerHTML=a.getAttribute("data-abstract")?a.getAttribute("data-abstract"):a.down(".tooltipicon").getAttribute("data-abstract");ToolTip.position(b.pointerX(b),b.pointerY(b));if(Prototype.Browser.IE){ToolTip.container.style.display="block"}return ToolTip.container.addClassName("isVisible")},hide:function(){if(Prototype.Browser.IE){ToolTip.container.style.display="block"}return ToolTip.container.removeClassName("isVisible")},position:function(a,c){var b;if(!Prototype.Browser.IE){ToolTip.container.style.maxWidth=(window.innerWidth-a-45)+"px"}b=((window.innerHeight-c-ToolTip.container.getHeight()-65)<0)?-30:10;ToolTip.container.style.left=(a+4)+"px";ToolTip.container.style.top=(c+b)+"px";return ToolTip.container}};(function fixPageTitle(){var a=$("pageTitle"),b;if(a&&a.up("#pediaContents")){b=document.createElement("div");b.addClassName("blue-background");b.innerHTML=a.innerHTML;a.innerHTML="";a.appendChild(b)}})();Event.observe(window,"load",function(){DevPubs.init();ToolTip.init()});